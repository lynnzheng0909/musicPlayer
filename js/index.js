var controlManager,songList,len,root=window.player,$scope=$(document.body),audio=new root.audioControl,status="pause",index=0;function bindEvent(){$scope.on("play:change",function(o,n){root.render(songList[n]),root.process.renderAllTime(songList[n]),root.process.update(),audio.getAudio(songList[n].audio),"play"==status&&(audio.play(),root.process.start())}),$scope.on("click",".prev-btn",function(){root.process.stop(),index=controlManager.prev(),$scope.trigger("play:change",index)}),$scope.on("click",".next-btn",function(){root.process.stop(),index=controlManager.next(),$scope.trigger("play:change",index)}),$scope.on("click",".play-btn",function(){"pause"==audio.status?(audio.play(),root.process.start(),status="play",$(".play-btn").addClass("playing")):(audio.pause(),root.process.stop(),status="pause",$(".play-btn").removeClass("playing"))})}function bindTouch(){var o=$scope.find(".slider-pointer"),n=$scope.find(".pro-wrapper").offset(),e=n.left,s=n.width;o.on("touchstart",function(){root.process.stop()}).on("touchmove",function(o){var n=(o.changedTouches[0].clientX-e)/s;n<0?n=0:1<n&&(n=1),root.process.update(n)}).on("touchend",function(o){var n=(o.changedTouches[0].clientX-e)/s;n<0?n=0:1<n&&(n=1);var t=n*songList[controlManager.index].duration;audio.playTo(t),status="play",root.process.changeLastPer(n),root.process.start(),$scope.find(".play-btn").addClass("playing")})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){len=(songList=o).length,root.render(o[0]),controlManager=new root.controlManager(0,len),bindEvent(),bindTouch(),$scope.trigger("play:change",index)},error:function(){}})}getData("../mock/data.json");